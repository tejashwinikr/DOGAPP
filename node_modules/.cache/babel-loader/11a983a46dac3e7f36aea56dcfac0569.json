{"ast":null,"code":"import { HttpRequest, objectEntries } from '@datadog/browser-core';\nexport var SEND_BEACON_BYTE_LENGTH_LIMIT = 60000;\nexport function send(endpointUrl, data, meta, rawSegmentSize) {\n  var formData = new FormData();\n  formData.set('segment', new Blob([data], {\n    type: 'application/octet-stream'\n  }), meta.session.id + \"-\" + meta.start);\n  toFormEntries(meta, function (key, value) {\n    return formData.set(key, value);\n  });\n  formData.set('raw_segment_size', rawSegmentSize.toString());\n  var request = new HttpRequest(endpointUrl, SEND_BEACON_BYTE_LENGTH_LIMIT);\n  request.send(formData, data.byteLength);\n}\nexport function toFormEntries(input, onEntry, prefix) {\n  if (prefix === void 0) {\n    prefix = '';\n  }\n\n  objectEntries(input).forEach(function (_a) {\n    var key = _a[0],\n        value = _a[1];\n\n    if (typeof value === 'object' && value !== null) {\n      toFormEntries(value, onEntry, \"\" + prefix + key + \".\");\n    } else {\n      onEntry(\"\" + prefix + key, String(value));\n    }\n  });\n}","map":{"version":3,"mappings":"AAAA,SAASA,WAAT,EAAsBC,aAAtB,QAA2C,uBAA3C;AAGA,OAAO,IAAMC,6BAA6B,GAAG,KAAtC;AAEP,OAAM,SAAUC,IAAV,CAAeC,WAAf,EAAoCC,IAApC,EAAsDC,IAAtD,EAAyEC,cAAzE,EAA+F;EACnG,IAAMC,QAAQ,GAAG,IAAIC,QAAJ,EAAjB;EAEAD,QAAQ,CAACE,GAAT,CACE,SADF,EAEE,IAAIC,IAAJ,CAAS,CAACN,IAAD,CAAT,EAAiB;IACfO,IAAI,EAAE;EADS,CAAjB,CAFF,EAKKN,IAAI,CAACO,OAAL,CAAaC,EAAb,GAAe,GAAf,GAAmBR,IAAI,CAACS,KAL7B;EAQAC,aAAa,CAACV,IAAD,EAAO,UAACW,GAAD,EAAMC,KAAN,EAAW;IAAK,eAAQ,CAACR,GAAT,CAAaO,GAAb,EAAkBC,KAAlB;EAAwB,CAA/C,CAAb;EACAV,QAAQ,CAACE,GAAT,CAAa,kBAAb,EAAiCH,cAAc,CAACY,QAAf,EAAjC;EAEA,IAAMC,OAAO,GAAG,IAAIpB,WAAJ,CAAgBI,WAAhB,EAA6BF,6BAA7B,CAAhB;EACAkB,OAAO,CAACjB,IAAR,CAAaK,QAAb,EAAuBH,IAAI,CAACgB,UAA5B;AACD;AAED,OAAM,SAAUL,aAAV,CAAwBM,KAAxB,EAAuCC,OAAvC,EAAsFC,MAAtF,EAAiG;EAAX;IAAAA;EAAW;;EACrGvB,aAAa,CAACqB,KAAD,CAAb,CAAmDG,OAAnD,CAA2D,UAACC,EAAD,EAAa;QAAXT,GAAG;QAAEC,KAAK;;IACrE,IAAI,OAAOA,KAAP,KAAiB,QAAjB,IAA6BA,KAAK,KAAK,IAA3C,EAAiD;MAC/CF,aAAa,CAACE,KAAD,EAAQK,OAAR,EAAiB,KAAGC,MAAH,GAAYP,GAAZ,GAAe,GAAhC,CAAb;IACD,CAFD,MAEO;MACLM,OAAO,CAAC,KAAGC,MAAH,GAAYP,GAAb,EAAoBU,MAAM,CAACT,KAAD,CAA1B,CAAP;IACD;EACF,CAND;AAOD","names":["HttpRequest","objectEntries","SEND_BEACON_BYTE_LENGTH_LIMIT","send","endpointUrl","data","meta","rawSegmentSize","formData","FormData","set","Blob","type","session","id","start","toFormEntries","key","value","toString","request","byteLength","input","onEntry","prefix","forEach","_a","String"],"sourceRoot":"","sources":["../../src/transport/send.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}