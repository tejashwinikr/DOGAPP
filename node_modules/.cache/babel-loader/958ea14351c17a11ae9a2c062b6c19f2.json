{"ast":null,"code":"import { monitor, addEventListener } from '@datadog/browser-core';\nexport function trackLocationChanges(onLocationChange) {\n  var stopHistoryTracking = trackHistory(onLocationChange).stop;\n  var stopHashTracking = trackHash(onLocationChange).stop;\n  return {\n    stop: function stop() {\n      stopHistoryTracking();\n      stopHashTracking();\n    }\n  };\n}\nexport function areDifferentLocation(currentLocation, otherLocation) {\n  return currentLocation.pathname !== otherLocation.pathname || !isHashAnAnchor(otherLocation.hash) && getPathFromHash(otherLocation.hash) !== getPathFromHash(currentLocation.hash);\n}\n\nfunction trackHistory(onHistoryChange) {\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  var originalPushState = history.pushState;\n  history.pushState = monitor(function () {\n    originalPushState.apply(this, arguments);\n    onHistoryChange();\n  }); // eslint-disable-next-line @typescript-eslint/unbound-method\n\n  var originalReplaceState = history.replaceState;\n  history.replaceState = monitor(function () {\n    originalReplaceState.apply(this, arguments);\n    onHistoryChange();\n  });\n  var removeListener = addEventListener(window, \"popstate\"\n  /* POP_STATE */\n  , onHistoryChange).stop;\n\n  var stop = function stop() {\n    removeListener();\n    history.pushState = originalPushState;\n    history.replaceState = originalReplaceState;\n  };\n\n  return {\n    stop: stop\n  };\n}\n\nfunction trackHash(onHashChange) {\n  return addEventListener(window, \"hashchange\"\n  /* HASH_CHANGE */\n  , onHashChange);\n}\n\nfunction isHashAnAnchor(hash) {\n  var correspondingId = hash.substr(1);\n  return !!document.getElementById(correspondingId);\n}\n\nfunction getPathFromHash(hash) {\n  var index = hash.indexOf('?');\n  return index < 0 ? hash : hash.slice(0, index);\n}","map":{"version":3,"mappings":"AAAA,SAASA,OAAT,EAAkBC,gBAAlB,QAAqD,uBAArD;AAEA,OAAM,SAAUC,oBAAV,CAA+BC,gBAA/B,EAA2D;EACvD,IAAMC,mBAAmB,GAAKC,YAAY,CAACF,gBAAD,CAAZ,CAA8BG,IAA5D;EACA,IAAMC,gBAAgB,GAAKC,SAAS,CAACL,gBAAD,CAAT,CAA2BG,IAAtD;EAER,OAAO;IACLA,IAAI,EAAE;MACJF,mBAAmB;MACnBG,gBAAgB;IACjB;EAJI,CAAP;AAMD;AAED,OAAM,SAAUE,oBAAV,CAA+BC,eAA/B,EAA0DC,aAA1D,EAAiF;EACrF,OACED,eAAe,CAACE,QAAhB,KAA6BD,aAAa,CAACC,QAA3C,IACC,CAACC,cAAc,CAACF,aAAa,CAACG,IAAf,CAAf,IACCC,eAAe,CAACJ,aAAa,CAACG,IAAf,CAAf,KAAwCC,eAAe,CAACL,eAAe,CAACI,IAAjB,CAH3D;AAKD;;AAED,SAAST,YAAT,CAAsBW,eAAtB,EAAiD;EAC/C;EACA,IAAMC,iBAAiB,GAAGC,OAAO,CAACC,SAAlC;EACAD,OAAO,CAACC,SAAR,GAAoBnB,OAAO,CAAC;IAC1BiB,iBAAiB,CAACG,KAAlB,CAAwB,IAAxB,EAA8BC,SAA9B;IACAL,eAAe;EAChB,CAH0B,CAA3B,CAH+C,CAO/C;;EACA,IAAMM,oBAAoB,GAAGJ,OAAO,CAACK,YAArC;EACAL,OAAO,CAACK,YAAR,GAAuBvB,OAAO,CAAC;IAC7BsB,oBAAoB,CAACF,KAArB,CAA2B,IAA3B,EAAiCC,SAAjC;IACAL,eAAe;EAChB,CAH6B,CAA9B;EAIQ,IAAMQ,cAAc,GAAKvB,gBAAgB,CAACwB,MAAD,EAAO;EAAA;EAAP,EAA8BT,eAA9B,CAAhB,CAA8DV,IAAvF;;EACR,IAAMA,IAAI,GAAG,SAAPA,IAAO;IACXkB,cAAc;IACdN,OAAO,CAACC,SAAR,GAAoBF,iBAApB;IACAC,OAAO,CAACK,YAAR,GAAuBD,oBAAvB;EACD,CAJD;;EAKA,OAAO;IAAEhB,IAAI;EAAN,CAAP;AACD;;AAED,SAASE,SAAT,CAAmBkB,YAAnB,EAA2C;EACzC,OAAOzB,gBAAgB,CAACwB,MAAD,EAAO;EAAA;EAAP,EAAgCC,YAAhC,CAAvB;AACD;;AAED,SAASb,cAAT,CAAwBC,IAAxB,EAAoC;EAClC,IAAMa,eAAe,GAAGb,IAAI,CAACc,MAAL,CAAY,CAAZ,CAAxB;EACA,OAAO,CAAC,CAACC,QAAQ,CAACC,cAAT,CAAwBH,eAAxB,CAAT;AACD;;AAED,SAASZ,eAAT,CAAyBD,IAAzB,EAAqC;EACnC,IAAMiB,KAAK,GAAGjB,IAAI,CAACkB,OAAL,CAAa,GAAb,CAAd;EACA,OAAOD,KAAK,GAAG,CAAR,GAAYjB,IAAZ,GAAmBA,IAAI,CAACmB,KAAL,CAAW,CAAX,EAAcF,KAAd,CAA1B;AACD","names":["monitor","addEventListener","trackLocationChanges","onLocationChange","stopHistoryTracking","trackHistory","stop","stopHashTracking","trackHash","areDifferentLocation","currentLocation","otherLocation","pathname","isHashAnAnchor","hash","getPathFromHash","onHistoryChange","originalPushState","history","pushState","apply","arguments","originalReplaceState","replaceState","removeListener","window","onHashChange","correspondingId","substr","document","getElementById","index","indexOf","slice"],"sourceRoot":"","sources":["../../../../src/domain/rumEventsCollection/view/trackLocationChanges.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}