{"ast":null,"code":"var _a;\n\nimport { __assign } from \"tslib\";\nimport { monitor, callMonitored, throttle, addEventListeners, addEventListener, includes } from '@datadog/browser-core';\nimport { NodePrivacyLevel } from '../../constants';\nimport { getNodePrivacyLevel, shouldMaskNode } from './privacy';\nimport { getElementInputValue, getSerializedNodeId, hasSerializedNode } from './serializationUtils';\nimport { IncrementalSource, MediaInteractions, MouseInteractions } from './types';\nimport { forEach, getWindowHeight, getWindowWidth, hookSetter, isTouchEvent } from './utils';\nimport { startMutationObserver } from './mutationObserver';\nvar MOUSE_MOVE_OBSERVER_THRESHOLD = 50;\nvar SCROLL_OBSERVER_THRESHOLD = 100;\nexport function initObservers(o) {\n  var mutationHandler = initMutationObserver(o.mutationController, o.mutationCb, o.initialPrivacyLevel);\n  var mousemoveHandler = initMoveObserver(o.mousemoveCb);\n  var mouseInteractionHandler = initMouseInteractionObserver(o.mouseInteractionCb, o.initialPrivacyLevel);\n  var scrollHandler = initScrollObserver(o.scrollCb, o.initialPrivacyLevel);\n  var viewportResizeHandler = initViewportResizeObserver(o.viewportResizeCb);\n  var inputHandler = initInputObserver(o.inputCb, o.initialPrivacyLevel);\n  var mediaInteractionHandler = initMediaInteractionObserver(o.mediaInteractionCb, o.initialPrivacyLevel);\n  var styleSheetObserver = initStyleSheetObserver(o.styleSheetRuleCb);\n  var focusHandler = initFocusObserver(o.focusCb);\n  return function () {\n    mutationHandler();\n    mousemoveHandler();\n    mouseInteractionHandler();\n    scrollHandler();\n    viewportResizeHandler();\n    inputHandler();\n    mediaInteractionHandler();\n    styleSheetObserver();\n    focusHandler();\n  };\n}\n\nfunction initMutationObserver(mutationController, cb, initialPrivacyLevel) {\n  return startMutationObserver(mutationController, cb, initialPrivacyLevel).stop;\n}\n\nfunction initMoveObserver(cb) {\n  var updatePosition = throttle(monitor(function (event) {\n    var target = event.target;\n\n    if (hasSerializedNode(target)) {\n      var _a = isTouchEvent(event) ? event.changedTouches[0] : event,\n          clientX = _a.clientX,\n          clientY = _a.clientY;\n\n      var position = {\n        id: getSerializedNodeId(target),\n        timeOffset: 0,\n        x: clientX,\n        y: clientY\n      };\n      cb([position], isTouchEvent(event) ? IncrementalSource.TouchMove : IncrementalSource.MouseMove);\n    }\n  }), MOUSE_MOVE_OBSERVER_THRESHOLD, {\n    trailing: false\n  }).throttled;\n  return addEventListeners(document, [\"mousemove\"\n  /* MOUSE_MOVE */\n  , \"touchmove\"\n  /* TOUCH_MOVE */\n  ], updatePosition, {\n    capture: true,\n    passive: true\n  }).stop;\n}\n\nvar eventTypeToMouseInteraction = (_a = {}, _a[\"mouseup\"\n/* MOUSE_UP */\n] = MouseInteractions.MouseUp, _a[\"mousedown\"\n/* MOUSE_DOWN */\n] = MouseInteractions.MouseDown, _a[\"click\"\n/* CLICK */\n] = MouseInteractions.Click, _a[\"contextmenu\"\n/* CONTEXT_MENU */\n] = MouseInteractions.ContextMenu, _a[\"dblclick\"\n/* DBL_CLICK */\n] = MouseInteractions.DblClick, _a[\"focus\"\n/* FOCUS */\n] = MouseInteractions.Focus, _a[\"blur\"\n/* BLUR */\n] = MouseInteractions.Blur, _a[\"touchstart\"\n/* TOUCH_START */\n] = MouseInteractions.TouchStart, _a[\"touchend\"\n/* TOUCH_END */\n] = MouseInteractions.TouchEnd, _a);\n\nfunction initMouseInteractionObserver(cb, initialPrivacyLevel) {\n  var handler = function handler(event) {\n    var target = event.target;\n\n    if (getNodePrivacyLevel(target, initialPrivacyLevel) === NodePrivacyLevel.HIDDEN || !hasSerializedNode(target)) {\n      return;\n    }\n\n    var _a = isTouchEvent(event) ? event.changedTouches[0] : event,\n        clientX = _a.clientX,\n        clientY = _a.clientY;\n\n    cb({\n      id: getSerializedNodeId(target),\n      type: eventTypeToMouseInteraction[event.type],\n      x: clientX,\n      y: clientY\n    });\n  };\n\n  return addEventListeners(document, Object.keys(eventTypeToMouseInteraction), handler, {\n    capture: true,\n    passive: true\n  }).stop;\n}\n\nfunction initScrollObserver(cb, initialPrivacyLevel) {\n  var updatePosition = throttle(monitor(function (event) {\n    var target = event.target;\n\n    if (!target || getNodePrivacyLevel(target, initialPrivacyLevel) === NodePrivacyLevel.HIDDEN || !hasSerializedNode(target)) {\n      return;\n    }\n\n    var id = getSerializedNodeId(target);\n\n    if (target === document) {\n      var scrollEl = document.scrollingElement || document.documentElement;\n      cb({\n        id: id,\n        x: scrollEl.scrollLeft,\n        y: scrollEl.scrollTop\n      });\n    } else {\n      cb({\n        id: id,\n        x: target.scrollLeft,\n        y: target.scrollTop\n      });\n    }\n  }), SCROLL_OBSERVER_THRESHOLD).throttled;\n  return addEventListener(document, \"scroll\"\n  /* SCROLL */\n  , updatePosition, {\n    capture: true,\n    passive: true\n  }).stop;\n}\n\nfunction initViewportResizeObserver(cb) {\n  var updateDimension = throttle(monitor(function () {\n    var height = getWindowHeight();\n    var width = getWindowWidth();\n    cb({\n      height: Number(height),\n      width: Number(width)\n    });\n  }), 200).throttled;\n  return addEventListener(window, \"resize\"\n  /* RESIZE */\n  , updateDimension, {\n    capture: true,\n    passive: true\n  }).stop;\n}\n\nexport var INPUT_TAGS = ['INPUT', 'TEXTAREA', 'SELECT'];\nvar lastInputStateMap = new WeakMap();\nexport function initInputObserver(cb, initialPrivacyLevel) {\n  function eventHandler(event) {\n    var target = event.target;\n    var nodePrivacyLevel = getNodePrivacyLevel(target, initialPrivacyLevel);\n\n    if (!target || !target.tagName || !includes(INPUT_TAGS, target.tagName) || nodePrivacyLevel === NodePrivacyLevel.HIDDEN) {\n      return;\n    }\n\n    var type = target.type;\n    var inputState;\n\n    if (type === 'radio' || type === 'checkbox') {\n      if (shouldMaskNode(target, nodePrivacyLevel)) {\n        return;\n      }\n\n      inputState = {\n        isChecked: target.checked\n      };\n    } else {\n      var value = getElementInputValue(target, nodePrivacyLevel);\n\n      if (value === undefined) {\n        return;\n      }\n\n      inputState = {\n        text: value\n      };\n    } // Can be multiple changes on the same node within the same batched mutation observation.\n\n\n    cbWithDedup(target, inputState); // If a radio was checked, other radios with the same name attribute will be unchecked.\n\n    var name = target.name;\n\n    if (type === 'radio' && name && target.checked) {\n      forEach(document.querySelectorAll(\"input[type=\\\"radio\\\"][name=\\\"\" + name + \"\\\"]\"), function (el) {\n        if (el !== target) {\n          // TODO: Consider the privacy implications for various differing input privacy levels\n          cbWithDedup(el, {\n            isChecked: false\n          });\n        }\n      });\n    }\n  }\n  /**\n   * There can be multiple changes on the same node within the same batched mutation observation.\n   */\n\n\n  function cbWithDedup(target, inputState) {\n    if (!hasSerializedNode(target)) {\n      return;\n    }\n\n    var lastInputState = lastInputStateMap.get(target);\n\n    if (!lastInputState || lastInputState.text !== inputState.text || lastInputState.isChecked !== inputState.isChecked) {\n      lastInputStateMap.set(target, inputState);\n      cb(__assign(__assign({}, inputState), {\n        id: getSerializedNodeId(target)\n      }));\n    }\n  }\n\n  var stopEventListeners = addEventListeners(document, [\"input\"\n  /* INPUT */\n  , \"change\"\n  /* CHANGE */\n  ], eventHandler, {\n    capture: true,\n    passive: true\n  }).stop;\n  var propertyDescriptor = Object.getOwnPropertyDescriptor(HTMLInputElement.prototype, 'value');\n  var hookProperties = [[HTMLInputElement.prototype, 'value'], [HTMLInputElement.prototype, 'checked'], [HTMLSelectElement.prototype, 'value'], [HTMLTextAreaElement.prototype, 'value'], // Some UI library use selectedIndex to set select value\n  [HTMLSelectElement.prototype, 'selectedIndex']];\n  var hookResetters = [];\n\n  if (propertyDescriptor && propertyDescriptor.set) {\n    hookResetters.push.apply(hookResetters, hookProperties.map(function (p) {\n      return hookSetter(p[0], p[1], {\n        set: monitor(function () {\n          // mock to a normal event\n          eventHandler({\n            target: this\n          });\n        })\n      });\n    }));\n  }\n\n  return function () {\n    hookResetters.forEach(function (h) {\n      return h();\n    });\n    stopEventListeners();\n  };\n}\n\nfunction initStyleSheetObserver(cb) {\n  // eslint-disable-next-line @typescript-eslint/unbound-method\n  var insertRule = CSSStyleSheet.prototype.insertRule;\n\n  CSSStyleSheet.prototype.insertRule = function (rule, index) {\n    var _this = this;\n\n    callMonitored(function () {\n      if (hasSerializedNode(_this.ownerNode)) {\n        cb({\n          id: getSerializedNodeId(_this.ownerNode),\n          adds: [{\n            rule: rule,\n            index: index\n          }]\n        });\n      }\n    });\n    return insertRule.call(this, rule, index);\n  }; // eslint-disable-next-line @typescript-eslint/unbound-method\n\n\n  var deleteRule = CSSStyleSheet.prototype.deleteRule;\n\n  CSSStyleSheet.prototype.deleteRule = function (index) {\n    var _this = this;\n\n    callMonitored(function () {\n      if (hasSerializedNode(_this.ownerNode)) {\n        cb({\n          id: getSerializedNodeId(_this.ownerNode),\n          removes: [{\n            index: index\n          }]\n        });\n      }\n    });\n    return deleteRule.call(this, index);\n  };\n\n  return function () {\n    CSSStyleSheet.prototype.insertRule = insertRule;\n    CSSStyleSheet.prototype.deleteRule = deleteRule;\n  };\n}\n\nfunction initMediaInteractionObserver(mediaInteractionCb, initialPrivacyLevel) {\n  var handler = function handler(event) {\n    var target = event.target;\n\n    if (!target || getNodePrivacyLevel(target, initialPrivacyLevel) === NodePrivacyLevel.HIDDEN || !hasSerializedNode(target)) {\n      return;\n    }\n\n    mediaInteractionCb({\n      id: getSerializedNodeId(target),\n      type: event.type === \"play\"\n      /* PLAY */\n      ? MediaInteractions.Play : MediaInteractions.Pause\n    });\n  };\n\n  return addEventListeners(document, [\"play\"\n  /* PLAY */\n  , \"pause\"\n  /* PAUSE */\n  ], handler, {\n    capture: true,\n    passive: true\n  }).stop;\n}\n\nfunction initFocusObserver(focusCb) {\n  return addEventListeners(window, [\"focus\"\n  /* FOCUS */\n  , \"blur\"\n  /* BLUR */\n  ], function () {\n    focusCb({\n      has_focus: document.hasFocus()\n    });\n  }).stop;\n}","map":{"version":3,"mappings":"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","names":["monitor","callMonitored","throttle","addEventListeners","addEventListener","includes","NodePrivacyLevel","getNodePrivacyLevel","shouldMaskNode","getElementInputValue","getSerializedNodeId","hasSerializedNode","IncrementalSource","MediaInteractions","MouseInteractions","forEach","getWindowHeight","getWindowWidth","hookSetter","isTouchEvent","startMutationObserver","MOUSE_MOVE_OBSERVER_THRESHOLD","SCROLL_OBSERVER_THRESHOLD","initObservers","o","mutationHandler","initMutationObserver","mutationController","mutationCb","initialPrivacyLevel","mousemoveHandler","initMoveObserver","mousemoveCb","mouseInteractionHandler","initMouseInteractionObserver","mouseInteractionCb","scrollHandler","initScrollObserver","scrollCb","viewportResizeHandler","initViewportResizeObserver","viewportResizeCb","inputHandler","initInputObserver","inputCb","mediaInteractionHandler","initMediaInteractionObserver","mediaInteractionCb","styleSheetObserver","initStyleSheetObserver","styleSheetRuleCb","focusHandler","initFocusObserver","focusCb","cb","stop","updatePosition","event","target","changedTouches","clientX","clientY","position","id","timeOffset","x","y","TouchMove","MouseMove","trailing","throttled","document","capture","passive","eventTypeToMouseInteraction","_a","MouseUp","MouseDown","Click","ContextMenu","DblClick","Focus","Blur","TouchStart","TouchEnd","handler","HIDDEN","type","Object","keys","scrollEl","scrollingElement","documentElement","scrollLeft","scrollTop","updateDimension","height","width","Number","window","INPUT_TAGS","lastInputStateMap","WeakMap","eventHandler","nodePrivacyLevel","tagName","inputState","isChecked","checked","value","undefined","text","cbWithDedup","name","querySelectorAll","el","lastInputState","get","set","stopEventListeners","propertyDescriptor","getOwnPropertyDescriptor","HTMLInputElement","prototype","hookProperties","HTMLSelectElement","HTMLTextAreaElement","hookResetters","push","apply","map","p","h","insertRule","CSSStyleSheet","rule","index","_this","ownerNode","adds","call","deleteRule","removes","Play","Pause","has_focus","hasFocus"],"sourceRoot":"","sources":["../../../src/domain/record/observer.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}